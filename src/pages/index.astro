---
export const prerender = false;
import { t } from "../lib/i18n";

const c = t("en");
const js = String.raw`(() => {
  try {
    const match = document.cookie.match(/(?:^|;)\s*idex_lang=([^;]+)/);
    const cookieLang = match ? (match[1] || "").toLowerCase() : "";
    const allowed = cookieLang === "nl" || cookieLang === "it" || cookieLang === "en";
    let lang = allowed ? cookieLang : "";
    if (!lang) {
      const langs = navigator.languages && navigator.languages.length
        ? navigator.languages
        : [navigator.language || "en"];
      const pref = (langs[0] || "en").toLowerCase();
      lang = (pref.startsWith("nl") ? "nl" : pref.startsWith("it") ? "it" : "en");
    }
    const target = "/" + lang + "/";
    if (location.pathname === "/" && !location.search.includes("noredirect=1")) {
      location.replace(target + location.search + location.hash);
    }
  } catch (e) {}
})();`;
---
<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="robots" content="noindex" />
    <title>{c.common.brandName}</title>
    <style>
      body{opacity:0;}
    </style>
    <script is:inline>{js}</script>
    <style>
      :root{ color-scheme: light; }
      html, body{ margin:0; padding:0; background:#f6f2ea; }
      body{ font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
      .noscript{ max-width: 720px; margin: 48px auto; padding: 0 24px; color:#0b1220; }
      .noscript a{ color:#0b1220; font-weight:700; text-decoration:none; }
    </style>
  </head>
  <body>
    <noscript>
      <style>body{opacity:1;}</style>
      <div class="noscript">
        <p>{c.common.noscriptNotice}</p>
        <p>
          <a href="/nl/">{c.common.noscriptNl}</a> ·
          <a href="/en/">{c.common.noscriptEn}</a> ·
          <a href="/it/">{c.common.noscriptIt}</a>
        </p>
      </div>
    </noscript>
    <script is:inline>
      {`if (location.search.includes("noredirect=1")) {
        document.addEventListener("DOMContentLoaded", () => {
          document.body.style.opacity = "1";
        });
      }`}
    </script>
  </body>
</html>
